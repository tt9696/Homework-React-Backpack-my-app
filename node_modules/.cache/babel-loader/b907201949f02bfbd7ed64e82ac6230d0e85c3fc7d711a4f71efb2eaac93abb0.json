{"ast":null,"code":"/*\n * Backpack - Skyscanner's Design System\n *\n * Copyright 2016 Skyscanner Ltd\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef, useState } from \"react\";\n\n// @ts-expect-error Untyped import. See `decisions/imports-ts-suppressions.md`.\nimport CSSTransition from 'react-transition-group/CSSTransition';\nimport cssModules from \"../cssModules\";\nimport STYLES from \"./BpkDialogWrapper.module.css\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nconst getClassName = cssModules(STYLES);\n;\n// TODO: this check if the browser support the HTML dialog element. We can remove it once we drop support as a business for Safari 14\nconst dialogSupported = typeof HTMLDialogElement === 'function';\nconst setPageProperties = ({\n  isDialogOpen\n}) => {\n  document.body.style.overflowY = isDialogOpen ? 'hidden' : 'visible';\n  if (!dialogSupported) {\n    document.body.style.position = isDialogOpen ? 'fixed' : 'relative';\n    document.body.style.width = isDialogOpen ? '100%' : 'auto';\n  }\n};\nexport const BpkDialogWrapper = ({\n  children,\n  closeOnEscPressed = false,\n  closeOnScrimClick = false,\n  dialogClassName = '',\n  exiting = false,\n  id,\n  isOpen,\n  onClose,\n  timeout = {\n    appear: 0,\n    exit: 0\n  },\n  transitionClassNames = {},\n  ...ariaProps\n}) => {\n  const ref = useRef(null);\n  const [dialogTarget, setDialogTarget] = useState(null);\n  useEffect(() => {\n    const dialog = document.getElementById(`${id}`);\n    const dialogWithPolyfill = document.getElementById(`${id}-polyfill`);\n    const handleBackdropClick = modal => {\n      if (closeOnScrimClick && modal) {\n        modal.addEventListener('click', event => {\n          const {\n            target\n          } = event;\n          if (target === modal) {\n            onClose(event, {\n              source: \"DOCUMENT_CLICK\"\n            });\n            event.stopPropagation();\n          }\n        });\n      }\n    };\n    const handleKeyDown = event => {\n      if (closeOnEscPressed && event.key === 'Escape' && (!dialogWithPolyfill || event.target === dialogWithPolyfill)) {\n        onClose(event, {\n          source: \"ESCAPE\"\n        });\n      }\n      event.stopPropagation();\n    };\n    if (isOpen) {\n      // There is a bug on older versions of browser using chromium (chrome, firefox, edge >114) where the dialog got an open attribute even before it is opened.\n      // Therefore, when trying to open it, it crashes and log an error mentioning the dialog has already an open attribute.\n      ref.current?.removeAttribute('open');\n      ref.current?.showModal?.();\n      if (dialogWithPolyfill) {\n        setDialogTarget(dialogWithPolyfill);\n        handleBackdropClick(dialogWithPolyfill);\n        window.addEventListener('keydown', handleKeyDown);\n      } else {\n        setDialogTarget(dialog);\n      }\n      handleBackdropClick(dialog);\n    } else {\n      ref.current?.close?.();\n    }\n    setPageProperties({\n      isDialogOpen: isOpen\n    });\n    return () => {\n      setPageProperties({\n        isDialogOpen: false\n      });\n      window.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [id, isOpen, onClose, closeOnEscPressed, closeOnScrimClick]);\n  const aria = {\n    ...(\"ariaLabelledby\" in ariaProps ? {\n      \"aria-labelledby\": ariaProps.ariaLabelledby\n    } : undefined),\n    ...(\"ariaLabel\" in ariaProps ? {\n      \"aria-label\": ariaProps.ariaLabel\n    } : undefined)\n  };\n  return isOpen ? /*#__PURE__*/_jsxs(\"div\", {\n    className: getClassName('bpk-dialog-wrapper', !dialogSupported && 'bpk-dialog-wrapper--polyfill'),\n    children: [!dialogSupported && /*#__PURE__*/_jsx(\"div\", {\n      id: `${id}-polyfill`,\n      className: getClassName('bpk-dialog-wrapper--backdrop'),\n      \"data-open\": isOpen\n    }), /*#__PURE__*/_jsx(CSSTransition, {\n      classNames: transitionClassNames,\n      in: !exiting,\n      appear: !exiting,\n      exit: exiting,\n      timeout: timeout,\n      children: /*#__PURE__*/_jsx(\"dialog\", {\n        ...aria,\n        id: id,\n        className: getClassName('bpk-dialog-wrapper--container', dialogClassName),\n        onCancel: e => {\n          e.preventDefault();\n          if (closeOnEscPressed && (!dialogTarget || e.target === dialogTarget)) {\n            onClose(e, {\n              source: 'ESCAPE'\n            });\n          }\n        },\n        \"data-open\": isOpen,\n        ref: ref,\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: getClassName('bpk-dialog-wrapper--contents'),\n          id: `${id}-contents`,\n          children: children\n        })\n      })\n    })]\n  }) : null;\n};","map":{"version":3,"names":["useEffect","useRef","useState","CSSTransition","cssModules","STYLES","jsx","_jsx","jsxs","_jsxs","getClassName","dialogSupported","HTMLDialogElement","setPageProperties","isDialogOpen","document","body","style","overflowY","position","width","BpkDialogWrapper","children","closeOnEscPressed","closeOnScrimClick","dialogClassName","exiting","id","isOpen","onClose","timeout","appear","exit","transitionClassNames","ariaProps","ref","dialogTarget","setDialogTarget","dialog","getElementById","dialogWithPolyfill","handleBackdropClick","modal","addEventListener","event","target","source","stopPropagation","handleKeyDown","key","current","removeAttribute","showModal","window","close","removeEventListener","aria","ariaLabelledby","undefined","ariaLabel","className","classNames","in","onCancel","e","preventDefault"],"sources":["C:/Users/Dell/my-app/node_modules/@skyscanner/backpack-web/bpk-react-utils/src/BpkDialogWrapper/BpkDialogWrapper.js"],"sourcesContent":["/*\n * Backpack - Skyscanner's Design System\n *\n * Copyright 2016 Skyscanner Ltd\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEffect, useRef, useState } from \"react\";\n\n// @ts-expect-error Untyped import. See `decisions/imports-ts-suppressions.md`.\nimport CSSTransition from 'react-transition-group/CSSTransition';\nimport cssModules from \"../cssModules\";\nimport STYLES from \"./BpkDialogWrapper.module.css\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nconst getClassName = cssModules(STYLES);\n;\n// TODO: this check if the browser support the HTML dialog element. We can remove it once we drop support as a business for Safari 14\nconst dialogSupported = typeof HTMLDialogElement === 'function';\nconst setPageProperties = ({\n  isDialogOpen\n}) => {\n  document.body.style.overflowY = isDialogOpen ? 'hidden' : 'visible';\n  if (!dialogSupported) {\n    document.body.style.position = isDialogOpen ? 'fixed' : 'relative';\n    document.body.style.width = isDialogOpen ? '100%' : 'auto';\n  }\n};\nexport const BpkDialogWrapper = ({\n  children,\n  closeOnEscPressed = false,\n  closeOnScrimClick = false,\n  dialogClassName = '',\n  exiting = false,\n  id,\n  isOpen,\n  onClose,\n  timeout = {\n    appear: 0,\n    exit: 0\n  },\n  transitionClassNames = {},\n  ...ariaProps\n}) => {\n  const ref = useRef(null);\n  const [dialogTarget, setDialogTarget] = useState(null);\n  useEffect(() => {\n    const dialog = document.getElementById(`${id}`);\n    const dialogWithPolyfill = document.getElementById(`${id}-polyfill`);\n    const handleBackdropClick = modal => {\n      if (closeOnScrimClick && modal) {\n        modal.addEventListener('click', event => {\n          const {\n            target\n          } = event;\n          if (target === modal) {\n            onClose(event, {\n              source: \"DOCUMENT_CLICK\"\n            });\n            event.stopPropagation();\n          }\n        });\n      }\n    };\n    const handleKeyDown = event => {\n      if (closeOnEscPressed && event.key === 'Escape' && (!dialogWithPolyfill || event.target === dialogWithPolyfill)) {\n        onClose(event, {\n          source: \"ESCAPE\"\n        });\n      }\n      event.stopPropagation();\n    };\n    if (isOpen) {\n      // There is a bug on older versions of browser using chromium (chrome, firefox, edge >114) where the dialog got an open attribute even before it is opened.\n      // Therefore, when trying to open it, it crashes and log an error mentioning the dialog has already an open attribute.\n      ref.current?.removeAttribute('open');\n      ref.current?.showModal?.();\n      if (dialogWithPolyfill) {\n        setDialogTarget(dialogWithPolyfill);\n        handleBackdropClick(dialogWithPolyfill);\n        window.addEventListener('keydown', handleKeyDown);\n      } else {\n        setDialogTarget(dialog);\n      }\n      handleBackdropClick(dialog);\n    } else {\n      ref.current?.close?.();\n    }\n    setPageProperties({\n      isDialogOpen: isOpen\n    });\n    return () => {\n      setPageProperties({\n        isDialogOpen: false\n      });\n      window.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [id, isOpen, onClose, closeOnEscPressed, closeOnScrimClick]);\n  const aria = {\n    ...(\"ariaLabelledby\" in ariaProps ? {\n      \"aria-labelledby\": ariaProps.ariaLabelledby\n    } : undefined),\n    ...(\"ariaLabel\" in ariaProps ? {\n      \"aria-label\": ariaProps.ariaLabel\n    } : undefined)\n  };\n  return isOpen ? /*#__PURE__*/_jsxs(\"div\", {\n    className: getClassName('bpk-dialog-wrapper', !dialogSupported && 'bpk-dialog-wrapper--polyfill'),\n    children: [!dialogSupported && /*#__PURE__*/_jsx(\"div\", {\n      id: `${id}-polyfill`,\n      className: getClassName('bpk-dialog-wrapper--backdrop'),\n      \"data-open\": isOpen\n    }), /*#__PURE__*/_jsx(CSSTransition, {\n      classNames: transitionClassNames,\n      in: !exiting,\n      appear: !exiting,\n      exit: exiting,\n      timeout: timeout,\n      children: /*#__PURE__*/_jsx(\"dialog\", {\n        ...aria,\n        id: id,\n        className: getClassName('bpk-dialog-wrapper--container', dialogClassName),\n        onCancel: e => {\n          e.preventDefault();\n          if (closeOnEscPressed && (!dialogTarget || e.target === dialogTarget)) {\n            onClose(e, {\n              source: 'ESCAPE'\n            });\n          }\n        },\n        \"data-open\": isOpen,\n        ref: ref,\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: getClassName('bpk-dialog-wrapper--contents'),\n          id: `${id}-contents`,\n          children: children\n        })\n      })\n    })]\n  }) : null;\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}